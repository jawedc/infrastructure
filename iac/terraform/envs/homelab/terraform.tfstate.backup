{
  "version": 4,
  "terraform_version": "1.12.0",
  "serial": 21,
  "lineage": "ecade561-84cc-1753-6dcd-3cc2c6c60c91",
  "outputs": {
    "k3s_node_ips": {
      "value": {
        "k3s-agent1": "192.168.1.177",
        "k3s-agent2": "192.168.1.41",
        "k3s-master": "192.168.1.91"
      },
      "type": [
        "object",
        {
          "k3s-agent1": "string",
          "k3s-agent2": "string",
          "k3s-master": "string"
        }
      ]
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "http",
      "name": "isos",
      "provider": "provider[\"registry.terraform.io/hashicorp/http\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "body": "{\"data\":[{\"volid\":\"local:iso/noble-server-cloudimg-amd64.img\",\"format\":\"iso\",\"size\":613432832,\"ctime\":1748796548,\"content\":\"iso\"}]}",
            "ca_cert_pem": null,
            "client_cert_pem": null,
            "client_key_pem": null,
            "id": "https://192.168.1.44:8006/api2/json/nodes/pve/storage/local/content?content=iso",
            "insecure": true,
            "method": null,
            "request_body": null,
            "request_headers": {
              "Authorization": "PVEAPIToken=terraform-prov@pve!terraform=5f6f822e-de7d-49f6-b360-e7849226c9a1"
            },
            "request_timeout_ms": null,
            "response_body": "{\"data\":[{\"volid\":\"local:iso/noble-server-cloudimg-amd64.img\",\"format\":\"iso\",\"size\":613432832,\"ctime\":1748796548,\"content\":\"iso\"}]}",
            "response_body_base64": "eyJkYXRhIjpbeyJ2b2xpZCI6ImxvY2FsOmlzby9ub2JsZS1zZXJ2ZXItY2xvdWRpbWctYW1kNjQuaW1nIiwiZm9ybWF0IjoiaXNvIiwic2l6ZSI6NjEzNDMyODMyLCJjdGltZSI6MTc0ODc5NjU0OCwiY29udGVudCI6ImlzbyJ9XX0=",
            "response_headers": {
              "Cache-Control": "max-age=0",
              "Content-Length": "131",
              "Content-Type": "application/json;charset=UTF-8",
              "Date": "Mon, 02 Jun 2025 16:43:47 GMT",
              "Expires": "Mon, 02 Jun 2025 16:43:47 GMT",
              "Pragma": "no-cache",
              "Server": "pve-api-daemon/3.0"
            },
            "retry": null,
            "status_code": 200,
            "url": "https://192.168.1.44:8006/api2/json/nodes/pve/storage/local/content?content=iso"
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "request_headers"
              },
              {
                "type": "index",
                "value": {
                  "value": "Authorization",
                  "type": "string"
                }
              }
            ]
          ],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "managed",
      "type": "proxmox_virtual_environment_file",
      "name": "user_data",
      "provider": "provider[\"registry.terraform.io/bpg/proxmox\"]",
      "instances": [
        {
          "index_key": "k3s-agent1",
          "schema_version": 0,
          "attributes": {
            "content_type": "snippets",
            "datastore_id": "local",
            "file_mode": null,
            "file_modification_date": null,
            "file_name": "k3s-agent1-user-data.yaml",
            "file_size": null,
            "file_tag": null,
            "id": "local:snippets/k3s-agent1-user-data.yaml",
            "node_name": "pve",
            "overwrite": true,
            "source_file": [],
            "source_raw": [
              {
                "data": "#cloud-config\nhostname: k3s-agent1\ntimezone: Europe/Paris\nusers:\n  - default\n  - name: ubuntu\n    groups: sudo\n    shell: /bin/bash\n    ssh_authorized_keys:\n      - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIALwpk3nInEFv6lDK0FfhT03UTrp3og13nI80xWTw2ev root@IAC_lxc\n    sudo: ALL=(ALL) NOPASSWD:ALL\n  - name: ansible\n    groups: sudo\n    shell: /bin/bash\n    ssh_authorized_keys:\n      - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIALwpk3nInEFv6lDK0FfhT03UTrp3og13nI80xWTw2ev root@IAC_lxc\n    sudo: ALL=(ALL) NOPASSWD:ALL\npackage_update: true\npackages:\n  - qemu-guest-agent\n  - net-tools\n  - curl\nruncmd:\n  - systemctl enable qemu-guest-agent\n  - systemctl start qemu-guest-agent\n  - echo \"done\" \u003e /tmp/cloud-config.done\n",
                "file_name": "k3s-agent1-user-data.yaml",
                "resize": 0
              }
            ],
            "timeout_upload": 1800
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA=="
        },
        {
          "index_key": "k3s-agent2",
          "schema_version": 0,
          "attributes": {
            "content_type": "snippets",
            "datastore_id": "local",
            "file_mode": null,
            "file_modification_date": null,
            "file_name": "k3s-agent2-user-data.yaml",
            "file_size": null,
            "file_tag": null,
            "id": "local:snippets/k3s-agent2-user-data.yaml",
            "node_name": "pve",
            "overwrite": true,
            "source_file": [],
            "source_raw": [
              {
                "data": "#cloud-config\nhostname: k3s-agent2\ntimezone: Europe/Paris\nusers:\n  - default\n  - name: ubuntu\n    groups: sudo\n    shell: /bin/bash\n    ssh_authorized_keys:\n      - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIALwpk3nInEFv6lDK0FfhT03UTrp3og13nI80xWTw2ev root@IAC_lxc\n    sudo: ALL=(ALL) NOPASSWD:ALL\n  - name: ansible\n    groups: sudo\n    shell: /bin/bash\n    ssh_authorized_keys:\n      - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIALwpk3nInEFv6lDK0FfhT03UTrp3og13nI80xWTw2ev root@IAC_lxc\n    sudo: ALL=(ALL) NOPASSWD:ALL\npackage_update: true\npackages:\n  - qemu-guest-agent\n  - net-tools\n  - curl\nruncmd:\n  - systemctl enable qemu-guest-agent\n  - systemctl start qemu-guest-agent\n  - echo \"done\" \u003e /tmp/cloud-config.done\n",
                "file_name": "k3s-agent2-user-data.yaml",
                "resize": 0
              }
            ],
            "timeout_upload": 1800
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA=="
        },
        {
          "index_key": "k3s-master",
          "schema_version": 0,
          "attributes": {
            "content_type": "snippets",
            "datastore_id": "local",
            "file_mode": null,
            "file_modification_date": null,
            "file_name": "k3s-master-user-data.yaml",
            "file_size": null,
            "file_tag": null,
            "id": "local:snippets/k3s-master-user-data.yaml",
            "node_name": "pve",
            "overwrite": true,
            "source_file": [],
            "source_raw": [
              {
                "data": "#cloud-config\nhostname: k3s-master\ntimezone: Europe/Paris\nusers:\n  - default\n  - name: ubuntu\n    groups: sudo\n    shell: /bin/bash\n    ssh_authorized_keys:\n      - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIALwpk3nInEFv6lDK0FfhT03UTrp3og13nI80xWTw2ev root@IAC_lxc\n    sudo: ALL=(ALL) NOPASSWD:ALL\n  - name: ansible\n    groups: sudo\n    shell: /bin/bash\n    ssh_authorized_keys:\n      - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIALwpk3nInEFv6lDK0FfhT03UTrp3og13nI80xWTw2ev root@IAC_lxc\n    sudo: ALL=(ALL) NOPASSWD:ALL\npackage_update: true\npackages:\n  - qemu-guest-agent\n  - net-tools\n  - curl\nruncmd:\n  - systemctl enable qemu-guest-agent\n  - systemctl start qemu-guest-agent\n  - echo \"done\" \u003e /tmp/cloud-config.done\n",
                "file_name": "k3s-master-user-data.yaml",
                "resize": 0
              }
            ],
            "timeout_upload": 1800
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.k3s_nodes[\"k3s-agent1\"]",
      "mode": "managed",
      "type": "proxmox_virtual_environment_vm",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/bpg/proxmox\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acpi": true,
            "agent": [
              {
                "enabled": true,
                "timeout": "15m",
                "trim": false,
                "type": "virtio"
              }
            ],
            "amd_sev": [],
            "audio_device": [],
            "bios": "seabios",
            "boot_order": null,
            "cdrom": [],
            "clone": [],
            "cpu": [
              {
                "affinity": "",
                "architecture": "",
                "cores": 2,
                "flags": null,
                "hotplugged": 0,
                "limit": 0,
                "numa": false,
                "sockets": 1,
                "type": "qemu64",
                "units": 1024
              }
            ],
            "description": "",
            "disk": [
              {
                "aio": "io_uring",
                "backup": true,
                "cache": "none",
                "datastore_id": "local-lvm",
                "discard": "on",
                "file_format": "raw",
                "file_id": "local:iso/noble-server-cloudimg-amd64.img",
                "interface": "virtio0",
                "iothread": true,
                "path_in_datastore": "vm-104-disk-0",
                "replicate": true,
                "serial": "",
                "size": 300,
                "speed": [],
                "ssd": false
              }
            ],
            "efi_disk": [],
            "hook_script_file_id": null,
            "hostpci": [],
            "id": "104",
            "initialization": [
              {
                "datastore_id": "local-lvm",
                "dns": [],
                "interface": "ide2",
                "ip_config": [
                  {
                    "ipv4": [
                      {
                        "address": "dhcp",
                        "gateway": ""
                      }
                    ],
                    "ipv6": []
                  }
                ],
                "meta_data_file_id": "",
                "network_data_file_id": "",
                "type": "",
                "user_account": [],
                "user_data_file_id": "local:snippets/k3s-agent1-user-data.yaml",
                "vendor_data_file_id": ""
              }
            ],
            "ipv4_addresses": [
              [
                "127.0.0.1"
              ],
              [
                "192.168.1.177"
              ]
            ],
            "ipv6_addresses": [
              [
                "::1"
              ],
              [
                "2a01:e0a:35c:5930:be24:11ff:febe:dc0a",
                "fe80::be24:11ff:febe:dc0a"
              ]
            ],
            "keyboard_layout": "en-us",
            "kvm_arguments": "",
            "mac_addresses": [
              "00:00:00:00:00:00",
              "BC:24:11:BE:DC:0A"
            ],
            "machine": "",
            "memory": [
              {
                "dedicated": 8192,
                "floating": 0,
                "hugepages": "",
                "keep_hugepages": false,
                "shared": 0
              }
            ],
            "migrate": false,
            "name": "k3s-agent1",
            "network_device": [
              {
                "bridge": "vmbr0",
                "disconnected": false,
                "enabled": true,
                "firewall": false,
                "mac_address": "BC:24:11:BE:DC:0A",
                "model": "virtio",
                "mtu": 0,
                "queues": 0,
                "rate_limit": 0,
                "trunks": "",
                "vlan_id": 0
              }
            ],
            "network_interface_names": [
              "lo",
              "eth0"
            ],
            "node_name": "pve",
            "numa": [],
            "on_boot": true,
            "operating_system": [],
            "pool_id": null,
            "protection": false,
            "reboot": false,
            "reboot_after_update": true,
            "rng": [],
            "scsi_hardware": "virtio-scsi-pci",
            "serial_device": [],
            "smbios": [],
            "started": true,
            "startup": [],
            "stop_on_destroy": false,
            "tablet_device": true,
            "tags": [
              "k3s-agent",
              "k3s-cluster",
              "ubuntu"
            ],
            "template": false,
            "timeout_clone": 1800,
            "timeout_create": 1800,
            "timeout_migrate": 1800,
            "timeout_move_disk": 1800,
            "timeout_reboot": 1800,
            "timeout_shutdown_vm": 1800,
            "timeout_start_vm": 1800,
            "timeout_stop_vm": 300,
            "tpm_state": [],
            "usb": [],
            "vga": [],
            "virtiofs": [],
            "vm_id": 104,
            "watchdog": []
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "data.http.isos",
            "proxmox_virtual_environment_download_file.image",
            "proxmox_virtual_environment_file.user_data"
          ]
        }
      ]
    },
    {
      "module": "module.k3s_nodes[\"k3s-agent2\"]",
      "mode": "managed",
      "type": "proxmox_virtual_environment_vm",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/bpg/proxmox\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acpi": true,
            "agent": [
              {
                "enabled": true,
                "timeout": "15m",
                "trim": false,
                "type": "virtio"
              }
            ],
            "amd_sev": [],
            "audio_device": [],
            "bios": "seabios",
            "boot_order": null,
            "cdrom": [],
            "clone": [],
            "cpu": [
              {
                "affinity": "",
                "architecture": "",
                "cores": 2,
                "flags": null,
                "hotplugged": 0,
                "limit": 0,
                "numa": false,
                "sockets": 1,
                "type": "qemu64",
                "units": 1024
              }
            ],
            "description": "",
            "disk": [
              {
                "aio": "io_uring",
                "backup": true,
                "cache": "none",
                "datastore_id": "local-lvm",
                "discard": "on",
                "file_format": "raw",
                "file_id": "local:iso/noble-server-cloudimg-amd64.img",
                "interface": "virtio0",
                "iothread": true,
                "path_in_datastore": "vm-103-disk-0",
                "replicate": true,
                "serial": "",
                "size": 300,
                "speed": [],
                "ssd": false
              }
            ],
            "efi_disk": [],
            "hook_script_file_id": null,
            "hostpci": [],
            "id": "103",
            "initialization": [
              {
                "datastore_id": "local-lvm",
                "dns": [],
                "interface": "ide2",
                "ip_config": [
                  {
                    "ipv4": [
                      {
                        "address": "dhcp",
                        "gateway": ""
                      }
                    ],
                    "ipv6": []
                  }
                ],
                "meta_data_file_id": "",
                "network_data_file_id": "",
                "type": "",
                "user_account": [],
                "user_data_file_id": "local:snippets/k3s-agent2-user-data.yaml",
                "vendor_data_file_id": ""
              }
            ],
            "ipv4_addresses": [
              [
                "127.0.0.1"
              ],
              [
                "192.168.1.41"
              ]
            ],
            "ipv6_addresses": [
              [
                "::1"
              ],
              [
                "2a01:e0a:35c:5930:be24:11ff:febc:fec",
                "fe80::be24:11ff:febc:fec"
              ]
            ],
            "keyboard_layout": "en-us",
            "kvm_arguments": "",
            "mac_addresses": [
              "00:00:00:00:00:00",
              "BC:24:11:BC:0F:EC"
            ],
            "machine": "",
            "memory": [
              {
                "dedicated": 8192,
                "floating": 0,
                "hugepages": "",
                "keep_hugepages": false,
                "shared": 0
              }
            ],
            "migrate": false,
            "name": "k3s-agent2",
            "network_device": [
              {
                "bridge": "vmbr0",
                "disconnected": false,
                "enabled": true,
                "firewall": false,
                "mac_address": "BC:24:11:BC:0F:EC",
                "model": "virtio",
                "mtu": 0,
                "queues": 0,
                "rate_limit": 0,
                "trunks": "",
                "vlan_id": 0
              }
            ],
            "network_interface_names": [
              "lo",
              "eth0"
            ],
            "node_name": "pve",
            "numa": [],
            "on_boot": true,
            "operating_system": [],
            "pool_id": null,
            "protection": false,
            "reboot": false,
            "reboot_after_update": true,
            "rng": [],
            "scsi_hardware": "virtio-scsi-pci",
            "serial_device": [],
            "smbios": [],
            "started": true,
            "startup": [],
            "stop_on_destroy": false,
            "tablet_device": true,
            "tags": [
              "k3s-agent",
              "k3s-cluster",
              "ubuntu"
            ],
            "template": false,
            "timeout_clone": 1800,
            "timeout_create": 1800,
            "timeout_migrate": 1800,
            "timeout_move_disk": 1800,
            "timeout_reboot": 1800,
            "timeout_shutdown_vm": 1800,
            "timeout_start_vm": 1800,
            "timeout_stop_vm": 300,
            "tpm_state": [],
            "usb": [],
            "vga": [],
            "virtiofs": [],
            "vm_id": 103,
            "watchdog": []
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "data.http.isos",
            "proxmox_virtual_environment_download_file.image",
            "proxmox_virtual_environment_file.user_data"
          ]
        }
      ]
    },
    {
      "module": "module.k3s_nodes[\"k3s-master\"]",
      "mode": "managed",
      "type": "proxmox_virtual_environment_vm",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/bpg/proxmox\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acpi": true,
            "agent": [
              {
                "enabled": true,
                "timeout": "15m",
                "trim": false,
                "type": "virtio"
              }
            ],
            "amd_sev": [],
            "audio_device": [],
            "bios": "seabios",
            "boot_order": null,
            "cdrom": [],
            "clone": [],
            "cpu": [
              {
                "affinity": "",
                "architecture": "",
                "cores": 2,
                "flags": null,
                "hotplugged": 0,
                "limit": 0,
                "numa": false,
                "sockets": 1,
                "type": "qemu64",
                "units": 1024
              }
            ],
            "description": "",
            "disk": [
              {
                "aio": "io_uring",
                "backup": true,
                "cache": "none",
                "datastore_id": "local-lvm",
                "discard": "on",
                "file_format": "raw",
                "file_id": "local:iso/noble-server-cloudimg-amd64.img",
                "interface": "virtio0",
                "iothread": true,
                "path_in_datastore": "vm-105-disk-0",
                "replicate": true,
                "serial": "",
                "size": 100,
                "speed": [],
                "ssd": false
              }
            ],
            "efi_disk": [],
            "hook_script_file_id": null,
            "hostpci": [],
            "id": "105",
            "initialization": [
              {
                "datastore_id": "local-lvm",
                "dns": [],
                "interface": "ide2",
                "ip_config": [
                  {
                    "ipv4": [
                      {
                        "address": "dhcp",
                        "gateway": ""
                      }
                    ],
                    "ipv6": []
                  }
                ],
                "meta_data_file_id": "",
                "network_data_file_id": "",
                "type": "",
                "user_account": [],
                "user_data_file_id": "local:snippets/k3s-master-user-data.yaml",
                "vendor_data_file_id": ""
              }
            ],
            "ipv4_addresses": [
              [
                "127.0.0.1"
              ],
              [
                "192.168.1.91"
              ]
            ],
            "ipv6_addresses": [
              [
                "::1"
              ],
              [
                "2a01:e0a:35c:5930:be24:11ff:fe32:bae",
                "fe80::be24:11ff:fe32:bae"
              ]
            ],
            "keyboard_layout": "en-us",
            "kvm_arguments": "",
            "mac_addresses": [
              "00:00:00:00:00:00",
              "BC:24:11:32:0B:AE"
            ],
            "machine": "",
            "memory": [
              {
                "dedicated": 4096,
                "floating": 0,
                "hugepages": "",
                "keep_hugepages": false,
                "shared": 0
              }
            ],
            "migrate": false,
            "name": "k3s-master",
            "network_device": [
              {
                "bridge": "vmbr0",
                "disconnected": false,
                "enabled": true,
                "firewall": false,
                "mac_address": "BC:24:11:32:0B:AE",
                "model": "virtio",
                "mtu": 0,
                "queues": 0,
                "rate_limit": 0,
                "trunks": "",
                "vlan_id": 0
              }
            ],
            "network_interface_names": [
              "lo",
              "eth0"
            ],
            "node_name": "pve",
            "numa": [],
            "on_boot": true,
            "operating_system": [],
            "pool_id": null,
            "protection": false,
            "reboot": false,
            "reboot_after_update": true,
            "rng": [],
            "scsi_hardware": "virtio-scsi-pci",
            "serial_device": [],
            "smbios": [],
            "started": true,
            "startup": [],
            "stop_on_destroy": false,
            "tablet_device": true,
            "tags": [
              "k3s-cluster",
              "k3s-master",
              "ubuntu"
            ],
            "template": false,
            "timeout_clone": 1800,
            "timeout_create": 1800,
            "timeout_migrate": 1800,
            "timeout_move_disk": 1800,
            "timeout_reboot": 1800,
            "timeout_shutdown_vm": 1800,
            "timeout_start_vm": 1800,
            "timeout_stop_vm": 300,
            "tpm_state": [],
            "usb": [],
            "vga": [],
            "virtiofs": [],
            "vm_id": 105,
            "watchdog": []
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "data.http.isos",
            "proxmox_virtual_environment_download_file.image",
            "proxmox_virtual_environment_file.user_data"
          ]
        }
      ]
    }
  ],
  "check_results": null
}
